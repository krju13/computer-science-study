영상: [[따라學IT] 04. 실제로 컴퓨터끼리는 IP주소를 사용해 데이터를 주고받는다](https://youtu.be/s5kIGnaNFvM?list=PL0d8NnikouEWcF1jJueLdjRIC4HsUlULi)

### 3계층의 기능

#### 3계층에서 하는 일

- 3계층은 다른 네트워크 대역. 즉, 멀리 떨어진 곳에 존재하는 네트워크까지 어떻게 데이터를 전달할지 제어하는 일을 담당
- 발신에서 착신까지의 패킷의 경로를 제어
- LAN과 LAN을 연결해주는 것
- 대표 장비: 라우터

#### 3계층에서 쓰는 주소
- WAN에서 통신할 때 사용하는 IP주소
  추가적으로
- 서브넷 마스크
- 기본 게이트웨이
  가 필요하다

##### IPv4주소: 
현재 PC에 할당된 IP주소
##### 서브넷 마스크: 
IP주소에 대한 네트워크의 대역을 규정하는 것
##### 게이트웨이주소: 
외부와 통신할 때 사용하는 네트워크의 출입구

#### 3계층 프로토콜
- ARP 프로토콜 : IP주소를 이용해 MAC 주소를 알아오는 프로토콜
  
- IPv4 프로토콜 : WAN에서 통신할 때 사용하는 프로토콜
  
- ICMP 프로토콜 : 서로 통신되는지 확인할 때 사용하는 프로토콜


### 일반적인 IP 주소

- Classhul IP 주소
  초창기에 클래스 별로 아이피주소를 나눠서 사용했다.

    + A클래스 네트워크 대역 : 0.0.0.0 ~ 127.255.255.255  
      맨 앞의 바이트로 대역을 구분한다. (128개 구분할 수 있다.)  
      2의 24제곱(16777216)개의 수만큼의 컴퓨터를 구분하는데 쓰일 수 있다.  
      그만큼 비효율적이다. 컴퓨터가 30대만 있는 대역에서 한 대역을 쓰면 나머지는 쓰이지 않는다.
<br>
    + B클래스 네트워크 대역: 128.0. 0.0 ~ 191.255. 255.255  
      앞의 2개 바이트의 대역으로 네트워크 대역을 나눈다.  
      하지만 여전히 대역이 크다.  

    +  C클래스 네트워크 대역: 192.0.0 0~ 191.255.255. 255  
       일반적으로 많이 쓰인 네트워크 대역  

    + D클래스 는 멀티캐스트를 위한 대역  
    + E클래스는 실험용으로 남겨둔 대역  

- Classfulless IP 주소  
  서브넷 마스크로 자르고 싶은 부분에서 자를 수 있도록 해준 주소
    + 서브넷 마스크
      클래스풀한 네트워크 대역을 나눠주는 데 사용하는 값  
      어디까지가 네트워크 대역을 구분하는데 사용하고 어디서부터 호스트를 구분하는데 사용하는지 지정  
      32 bit 4바이트  
      255.255.255.192 -> 11111111.11111111.11111111.11000000  
      2진수로 표기했을 때 1로 시작, 1과 1사이에는 0이 올 수 없다는 규칙을 가지고 있다.
- 사설 IP와 공인 IP
  공인IP 1개당 2^32개의 사설IP가 있다.  
  사설IP를 쓰는 애들은 공인IP로 바꿔서 외부랑 통신을 한다.  
  외부에서는 나에대해 공인IP만 알고 주고  
  공유기가 누가 이 데이터를 원했는지 알고 사설IP에게 넘겨준다.  
  이렇게 넘겨는 것을 NAT라고 한다.  
  아이피를 아이피로 바꾸는 기술이 NAT라고 하는데 보통 이렇게 쓴다.  

외부에서는 사설네트워크가 안보이고 공인아이피만으로 통신하는것처럼 보인다.

NAT테이블에 내부아이피를 기록하고 데이터가 들어오면 그걸 내부에 전달한다.  
외부에 넘긴적이 없는 데이터가 들어오면 공유기가 안으로 들이지 않는다.  
안에서 밖의 이벤트를 받아야 하면 추가로 설정을 해야한다.


### 특수한 IP 주소

- wildcard 0.0.0.0  
  <b>나머지 모든 아이피</b>

- 127.0.0.1
  나자신을 나타내는 주소

- 게이트웨이 주소
  어딘가로 가려면 일단 여기로 간다.
  쓸수 있는 아이피중에 가장 낮거나 가장 높은 아이피 주소를 적는다. 


